INFO:	main:	Namespace(n_degree=20, n_head=2, n_layer=2, drop_out=0.1, reg=0.1, node_dim=32, time_dim=32, agg_method='attn', attn_mode='map', uniform=True, new_node=False, time='disentangle', disencomponents=10, data='ml-100k', samplerate=1.0, popnegsample=False, timepopnegsample=False, negsampleeval=3000, bs=256, n_epoch=500, lr=0.0001, prefix='ml100k', gpu=0, seed=42, l2=0.0001)
INFO:	TGSRec:	Aggregation uses attention model
INFO:	attention_model:	Using map based attention
INFO:	attention_model:	Using scaled prod attention
INFO:	attention_model:	Using map based attention
INFO:	attention_model:	Using scaled prod attention
INFO:	TGSRec:	Using disentangle time encoding
INFO:	trainer:	Model built successfully
INFO:	trainer:	TGRec(
  (node_hist_embed): Embedding(2626, 32)
  (merge_layer): MergeLayer(
    (fc1): Linear(in_features=64, out_features=32, bias=True)
    (fc2): Linear(in_features=32, out_features=32, bias=True)
    (act): ReLU()
  )
  (attn_model_list): ModuleList(
    (0-1): 2 x CrossAttentionModel(
      (ffn): MergeLayer(
        (fc1): Linear(in_features=96, out_features=32, bias=True)
        (fc2): Linear(in_features=32, out_features=32, bias=True)
        (act): ReLU()
      )
      (multi_head_target): MapBasedMultiHeadAttention(
        (wq_node_transform): Linear(in_features=64, out_features=64, bias=False)
        (wk_node_transform): Linear(in_features=64, out_features=64, bias=False)
        (wv_node_transform): Linear(in_features=64, out_features=64, bias=False)
        (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (fc): Linear(in_features=64, out_features=64, bias=True)
        (act): LeakyReLU(negative_slope=0.2)
        (weight_map): Linear(in_features=64, out_features=1, bias=False)
        (dropout): Dropout(p=0.1, inplace=False)
        (softmax): Softmax(dim=2)
      )
      (self_attn_model): SelfAttentionModel(
        (ffn): MergeSelfAttnLayer(
          (fc1): Linear(in_features=96, out_features=5120, bias=True)
          (fc2): Linear(in_features=5120, out_features=64, bias=True)
          (act): ReLU()
        )
        (multi_head_target): MultiHeadAttention(
          (w_qs): Linear(in_features=64, out_features=64, bias=False)
          (w_ks): Linear(in_features=64, out_features=64, bias=False)
          (w_vs): Linear(in_features=64, out_features=64, bias=False)
          (attention): ScaledDotProductAttention(
            (dropout): Dropout(p=0.1, inplace=False)
            (softmax): Softmax(dim=2)
          )
          (layer_norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (fc): Linear(in_features=64, out_features=64, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
  )
  (time_encoder): DisentangleTimeEncode()
  (affinity_score): MergeLayer(
    (fc1): Linear(in_features=64, out_features=32, bias=True)
    (fc2): Linear(in_features=32, out_features=1, bias=True)
    (act): ReLU()
  )
)
INFO:	trainer:	Optimizer: Adam with lr: 0.0001 and l2: 0.0001
INFO:	trainer:	Learning rate scheduler: LinearLR
INFO:	trainer:	Warmup scheduler: LinearWarmup
INFO:	trainer:	Device: cuda:0
INFO:	trainer:	Number of nodes: 2625
INFO:	trainer:	Number of edges: 100000
INFO:	callbacks:	Early stopping monitor: max_round=10, higher_better=True, tolerance=0.001
INFO:	main:	Commencing training for 500 epochs
INFO:	trainer:	Epoch [1/500]:	Train Loss: 16.9108	Train Acc: 0.6651	Train AP: 0.6806	Train F1: 0.7232	Train AUC: 0.7268	Val Acc: 0.5526	Val AP: 0.6864	Val F1: 0.6908	Val AUC: 0.7338	Test Acc: 0.5504	Test AP: 0.7070	Test F1: 0.6893	Test AUC: 0.7613
INFO:	trainer:	Epoch [2/500]:	Train Loss: 16.0890	Train Acc: 0.7191	Train AP: 0.7615	Train F1: 0.7487	Train AUC: 0.7932	Val Acc: 0.5349	Val AP: 0.7057	Val F1: 0.6823	Val AUC: 0.7460	Test Acc: 0.5453	Test AP: 0.6927	Test F1: 0.6874	Test AUC: 0.7595
INFO:	trainer:	Epoch [3/500]:	Train Loss: 15.3390	Train Acc: 0.7351	Train AP: 0.7859	Train F1: 0.7477	Train AUC: 0.8118	Val Acc: 0.5839	Val AP: 0.6993	Val F1: 0.7057	Val AUC: 0.7390	Test Acc: 0.5806	Test AP: 0.6906	Test F1: 0.7032	Test AUC: 0.7552
INFO:	trainer:	Epoch [4/500]:	Train Loss: 14.6138	Train Acc: 0.7419	Train AP: 0.7999	Train F1: 0.7444	Train AUC: 0.8217	Val Acc: 0.5872	Val AP: 0.7308	Val F1: 0.7068	Val AUC: 0.7589	Test Acc: 0.5774	Test AP: 0.7039	Test F1: 0.7028	Test AUC: 0.7701
INFO:	trainer:	Epoch [5/500]:	Train Loss: 13.9080	Train Acc: 0.7459	Train AP: 0.8062	Train F1: 0.7417	Train AUC: 0.8261	Val Acc: 0.5844	Val AP: 0.7311	Val F1: 0.7058	Val AUC: 0.7592	Test Acc: 0.5737	Test AP: 0.7198	Test F1: 0.7008	Test AUC: 0.7646
INFO:	trainer:	Epoch [6/500]:	Train Loss: 13.2200	Train Acc: 0.7483	Train AP: 0.8134	Train F1: 0.7402	Train AUC: 0.8311	Val Acc: 0.5763	Val AP: 0.7365	Val F1: 0.7015	Val AUC: 0.7624	Test Acc: 0.5649	Test AP: 0.7188	Test F1: 0.6965	Test AUC: 0.7713
INFO:	trainer:	Epoch [7/500]:	Train Loss: 12.5440	Train Acc: 0.7481	Train AP: 0.8170	Train F1: 0.7325	Train AUC: 0.8350	Val Acc: 0.5782	Val AP: 0.7433	Val F1: 0.7030	Val AUC: 0.7741	Test Acc: 0.5762	Test AP: 0.7517	Test F1: 0.7015	Test AUC: 0.7866
INFO:	trainer:	Epoch [8/500]:	Train Loss: 11.8827	Train Acc: 0.7505	Train AP: 0.8230	Train F1: 0.7312	Train AUC: 0.8387	Val Acc: 0.5754	Val AP: 0.7421	Val F1: 0.7018	Val AUC: 0.7706	Test Acc: 0.5632	Test AP: 0.7507	Test F1: 0.6957	Test AUC: 0.7833
INFO:	trainer:	Epoch [9/500]:	Train Loss: 11.2364	Train Acc: 0.7499	Train AP: 0.8228	Train F1: 0.7279	Train AUC: 0.8387	Val Acc: 0.6006	Val AP: 0.7259	Val F1: 0.7133	Val AUC: 0.7532	Test Acc: 0.6157	Test AP: 0.7174	Test F1: 0.7211	Test AUC: 0.7602
INFO:	trainer:	Epoch [10/500]:	Train Loss: 10.5984	Train Acc: 0.7462	Train AP: 0.8247	Train F1: 0.7190	Train AUC: 0.8414	Val Acc: 0.5976	Val AP: 0.7455	Val F1: 0.7128	Val AUC: 0.7770	Test Acc: 0.5841	Test AP: 0.7329	Test F1: 0.7053	Test AUC: 0.7726
INFO:	trainer:	Epoch [11/500]:	Train Loss: 9.9805	Train Acc: 0.7446	Train AP: 0.8249	Train F1: 0.7169	Train AUC: 0.8401	Val Acc: 0.6086	Val AP: 0.7560	Val F1: 0.7184	Val AUC: 0.7787	Test Acc: 0.5922	Test AP: 0.7223	Test F1: 0.7078	Test AUC: 0.7591
INFO:	trainer:	Epoch [12/500]:	Train Loss: 9.3679	Train Acc: 0.7508	Train AP: 0.8298	Train F1: 0.7267	Train AUC: 0.8441	Val Acc: 0.6103	Val AP: 0.7648	Val F1: 0.7183	Val AUC: 0.7880	Test Acc: 0.6106	Test AP: 0.7407	Test F1: 0.7175	Test AUC: 0.7760
INFO:	trainer:	Epoch [13/500]:	Train Loss: 8.7764	Train Acc: 0.7563	Train AP: 0.8306	Train F1: 0.7363	Train AUC: 0.8458	Val Acc: 0.6189	Val AP: 0.7643	Val F1: 0.7237	Val AUC: 0.7877	Test Acc: 0.6038	Test AP: 0.7552	Test F1: 0.7152	Test AUC: 0.7864
INFO:	trainer:	Epoch [14/500]:	Train Loss: 8.1935	Train Acc: 0.7547	Train AP: 0.8336	Train F1: 0.7307	Train AUC: 0.8489	Val Acc: 0.6007	Val AP: 0.7908	Val F1: 0.7137	Val AUC: 0.8075	Test Acc: 0.5897	Test AP: 0.7769	Test F1: 0.7078	Test AUC: 0.8004
INFO:	trainer:	Epoch [15/500]:	Train Loss: 7.6282	Train Acc: 0.7546	Train AP: 0.8329	Train F1: 0.7332	Train AUC: 0.8474	Val Acc: 0.6182	Val AP: 0.7485	Val F1: 0.7212	Val AUC: 0.7677	Test Acc: 0.6237	Test AP: 0.7368	Test F1: 0.7221	Test AUC: 0.7645
INFO:	trainer:	Epoch [16/500]:	Train Loss: 7.0698	Train Acc: 0.7555	Train AP: 0.8358	Train F1: 0.7303	Train AUC: 0.8500	Val Acc: 0.6073	Val AP: 0.7595	Val F1: 0.7162	Val AUC: 0.7812	Test Acc: 0.6209	Test AP: 0.7627	Test F1: 0.7233	Test AUC: 0.7977
INFO:	trainer:	Epoch [17/500]:	Train Loss: 6.5262	Train Acc: 0.7602	Train AP: 0.8404	Train F1: 0.7389	Train AUC: 0.8535	Val Acc: 0.6319	Val AP: 0.7461	Val F1: 0.7293	Val AUC: 0.7819	Test Acc: 0.6334	Test AP: 0.7196	Test F1: 0.7288	Test AUC: 0.7640
INFO:	trainer:	Epoch [18/500]:	Train Loss: 5.9995	Train Acc: 0.7521	Train AP: 0.8393	Train F1: 0.7202	Train AUC: 0.8531	Val Acc: 0.6213	Val AP: 0.7582	Val F1: 0.7238	Val AUC: 0.7821	Test Acc: 0.6327	Test AP: 0.7696	Test F1: 0.7294	Test AUC: 0.7949
INFO:	trainer:	Epoch [19/500]:	Train Loss: 5.4909	Train Acc: 0.7544	Train AP: 0.8423	Train F1: 0.7247	Train AUC: 0.8548	Val Acc: 0.6309	Val AP: 0.7542	Val F1: 0.7281	Val AUC: 0.7782	Test Acc: 0.6242	Test AP: 0.7323	Test F1: 0.7224	Test AUC: 0.7647
INFO:	trainer:	Epoch [20/500]:	Train Loss: 4.9945	Train Acc: 0.7544	Train AP: 0.8420	Train F1: 0.7250	Train AUC: 0.8549	Val Acc: 0.6363	Val AP: 0.7810	Val F1: 0.7305	Val AUC: 0.8066	Test Acc: 0.6391	Test AP: 0.7650	Test F1: 0.7316	Test AUC: 0.7949
INFO:	trainer:	Epoch [21/500]:	Train Loss: 4.5195	Train Acc: 0.7547	Train AP: 0.8430	Train F1: 0.7240	Train AUC: 0.8555	Val Acc: 0.6291	Val AP: 0.7601	Val F1: 0.7284	Val AUC: 0.7882	Test Acc: 0.6452	Test AP: 0.7598	Test F1: 0.7364	Test AUC: 0.7957
INFO:	trainer:	Epoch [22/500]:	Train Loss: 4.0536	Train Acc: 0.7618	Train AP: 0.8472	Train F1: 0.7352	Train AUC: 0.8595	Val Acc: 0.6206	Val AP: 0.7678	Val F1: 0.7230	Val AUC: 0.7928	Test Acc: 0.6360	Test AP: 0.7655	Test F1: 0.7299	Test AUC: 0.7986
INFO:	trainer:	Epoch [23/500]:	Train Loss: 3.6165	Train Acc: 0.7612	Train AP: 0.8451	Train F1: 0.7372	Train AUC: 0.8579	Val Acc: 0.6405	Val AP: 0.7450	Val F1: 0.7337	Val AUC: 0.7719	Test Acc: 0.6255	Test AP: 0.7340	Test F1: 0.7219	Test AUC: 0.7733
INFO:	trainer:	Epoch [24/500]:	Train Loss: 3.1969	Train Acc: 0.7628	Train AP: 0.8483	Train F1: 0.7388	Train AUC: 0.8598	Val Acc: 0.6368	Val AP: 0.7638	Val F1: 0.7304	Val AUC: 0.7815	Test Acc: 0.6371	Test AP: 0.7535	Test F1: 0.7289	Test AUC: 0.7856
INFO:	trainer:	Epoch [25/500]:	Train Loss: 2.7997	Train Acc: 0.7566	Train AP: 0.8480	Train F1: 0.7279	Train AUC: 0.8592	Val Acc: 0.6556	Val AP: 0.7698	Val F1: 0.7403	Val AUC: 0.7912	Test Acc: 0.6568	Test AP: 0.7625	Test F1: 0.7386	Test AUC: 0.7957
INFO:	trainer:	Epoch [26/500]:	Train Loss: 2.4267	Train Acc: 0.7578	Train AP: 0.8481	Train F1: 0.7277	Train AUC: 0.8600	Val Acc: 0.6451	Val AP: 0.7737	Val F1: 0.7360	Val AUC: 0.7994	Test Acc: 0.6443	Test AP: 0.7640	Test F1: 0.7352	Test AUC: 0.7954
INFO:	trainer:	Epoch [27/500]:	Train Loss: 2.0822	Train Acc: 0.7569	Train AP: 0.8500	Train F1: 0.7241	Train AUC: 0.8611	Val Acc: 0.6409	Val AP: 0.7754	Val F1: 0.7332	Val AUC: 0.7976	Test Acc: 0.6414	Test AP: 0.7558	Test F1: 0.7334	Test AUC: 0.7855
INFO:	trainer:	Epoch [28/500]:	Train Loss: 1.7684	Train Acc: 0.7581	Train AP: 0.8508	Train F1: 0.7254	Train AUC: 0.8628	Val Acc: 0.6319	Val AP: 0.7549	Val F1: 0.7289	Val AUC: 0.7706	Test Acc: 0.6358	Test AP: 0.7428	Test F1: 0.7317	Test AUC: 0.7739
INFO:	trainer:	Epoch [29/500]:	Train Loss: 1.4854	Train Acc: 0.7538	Train AP: 0.8526	Train F1: 0.7151	Train AUC: 0.8638	Val Acc: 0.6506	Val AP: 0.7703	Val F1: 0.7382	Val AUC: 0.7986	Test Acc: 0.6345	Test AP: 0.7576	Test F1: 0.7284	Test AUC: 0.7896
INFO:	trainer:	Early stopping at epoch 30
INFO:	main:	Training finished
INFO:	main:	Plotting results
INFO:	main:	Plotting finished
INFO:	trainer:	History exported to /home/FYP/siddhant005/fyp/log/140324-200442_history.json
INFO:	main:	Completed main file execution. Exiting...
