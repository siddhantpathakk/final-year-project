INFO: main_v2: 2024-03-02 11:30:25,878: Using seed: 42
INFO: main_v2: 2024-03-02 11:30:25,878: Using device: cpu
INFO: main_v2: 2024-03-02 11:30:25,878: Commencing data collection for ml100k
INFO: dataloader: 2024-03-02 11:30:26,133: Data preprocessing completed
INFO: dataloader: 2024-03-02 11:30:26,133: uid2locid_time: 563 
INFO: dataloader: 2024-03-02 11:30:26,133: locid2detail: 1442 
INFO: dataloader: 2024-03-02 11:30:26,133: node_num: 2010 
INFO: dataloader: 2024-03-02 11:30:26,133: relation_num: 4 
INFO: dataloader: 2024-03-02 11:30:26,133: user_num: 563 
INFO: dataloader: 2024-03-02 11:30:26,133: train_num: 3941 
INFO: dataloader: 2024-03-02 11:30:26,133: test_num: 563 
INFO: dataloader: 2024-03-02 11:30:26,133: train_set: (3941, 14) 
INFO: dataloader: 2024-03-02 11:30:26,133: test_set: (563, 11) 
INFO: dataloader: 2024-03-02 11:30:26,133: uid_list_: 563 
INFO: dataloader: 2024-03-02 11:30:26,133: u2v: 563 
INFO: dataloader: 2024-03-02 11:30:26,133: u2vc: 563 
INFO: dataloader: 2024-03-02 11:30:26,133: v2u: 1442 
INFO: dataloader: 2024-03-02 11:30:26,133: v2vc: 1442 
INFO: main_v2: 2024-03-02 11:30:26,133: Commencing training for 500 epochs
INFO: trainer_v2: 2024-03-02 11:30:26,153: CAGSRec(
  (FFN): Sequential(
    (0): PointWiseFeedForward(
      (conv1): Conv1d(192, 192, kernel_size=(1,), stride=(1,))
      (dropout1): Dropout(p=0.1, inplace=False)
      (relu): ReLU()
      (conv2): Conv1d(192, 192, kernel_size=(1,), stride=(1,))
      (dropout2): Dropout(p=0.1, inplace=False)
    )
    (1): LayerNorm((192,), eps=1e-08, elementwise_affine=True)
  )
  (temporal_seq_attn_layer): TemporalSequentialAttentionLayer(
    (multihead_attn): MultiheadAttention(
      (out_proj): NonDynamicallyQuantizableLinear(in_features=192, out_features=192, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (layer_norm): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
    (feedforward): Sequential(
      (0): PointWiseFeedForward(
        (conv1): Conv1d(192, 192, kernel_size=(1,), stride=(1,))
        (dropout1): Dropout(p=0.1, inplace=False)
        (relu): ReLU()
        (conv2): Conv1d(192, 192, kernel_size=(1,), stride=(1,))
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): LayerNorm((192,), eps=1e-08, elementwise_affine=True)
    )
  )
  (cross_attn_layer): CrossAttentionLayer(
    (multihead_attn): MultiheadAttention(
      (out_proj): NonDynamicallyQuantizableLinear(in_features=192, out_features=192, bias=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (layer_norm): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
    (feedforward): Sequential(
      (0): PointWiseFeedForward(
        (conv1): Conv1d(192, 192, kernel_size=(1,), stride=(1,))
        (dropout1): Dropout(p=0.1, inplace=False)
        (relu): ReLU()
        (conv2): Conv1d(192, 192, kernel_size=(1,), stride=(1,))
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): LayerNorm((192,), eps=1e-08, elementwise_affine=True)
    )
  )
  (long_term_gnn): LongTermGNN(
    (conv_modulelist): ModuleList(
      (0-2): 3 x ImprovedGNNunit(32, 32, num_relations=4)
    )
  )
  (short_term_gnn): ShortTermGNN(
    (short_conv_modulelist): ModuleList(
      (0-2): 3 x ImprovedGNNunit(32, 32, num_relations=4)
    )
  )
  (predict_emb_w): Embedding(1442, 192, padding_idx=0)
  (predict_emb_b): Embedding(1442, 1, padding_idx=0)
  (node_embeddings): Embedding(2010, 32, padding_idx=0)
)
INFO: trainer_v2: 2024-03-02 11:30:26,153: Optimizer:	Adam with initial lr = 0.001, l2 = 0.0001
INFO: trainer_v2: 2024-03-02 11:30:26,153: LR Scheduler:	LinearLR
